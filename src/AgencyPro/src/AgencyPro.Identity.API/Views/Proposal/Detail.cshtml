@model AgencyPro.Core.Proposals.ViewModels.FixedPriceProposalDetailOutput

@{
    Layout = null;

    string acceptMessage = string.Empty;
    @if (TempData["ProposalAcceptStatus"] != null && !string.IsNullOrEmpty(TempData["ProposalAcceptStatus"].ToString()?.Trim()))
    {
        acceptMessage = TempData["ProposalAcceptStatus"].ToString();
    }

    string rejectMessage = string.Empty;
    @if (TempData["ProposalRejectStatus"] != null && !string.IsNullOrEmpty(TempData["ProposalRejectStatus"].ToString()?.Trim()))
    {
        rejectMessage = TempData["ProposalRejectStatus"].ToString();
    }
}

<html>
<head>
    <link href="~/lib/bootstrap/css/bootstrap.css" rel="stylesheet">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="description" content="AgencyPro - It's time to power up your agency." />
    <link rel="stylesheet" type="text/css" href="~/styles/portal.css" />
    <link href="~/css/ProposalStyles.css" rel="stylesheet">
</head>
<body class="has-navbar-fixed-top">
    <nav class="navbar  is-fixed-top" role="navigation" aria-label="main navigation">
        <div class="container is-fluid">
            <div class="navbar-brand">
                <a class="navbar-item" href="/"><img src="~/images/logo-white.svg" alt=""></a>
                <div class="navmenu-container" data-target="navbarHeader" role="button">
                    <input id="responsive-menu" type="checkbox">
                    <label for="responsive-menu"><span id="menu-icon"><em></em></span></label>
                    <div id="mobilemenu">
                        <div class="mobile-menu-container">
                            <div class="mobile-menu-top">
                                <img class="mobile-logo" src="~/images/logo-white.svg"
                                     alt="AgencyPro - B2B Professional Services Platform." />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="main-div">
        <div class="form-group header-div-style">
            <div class="col-md-6">
                <h1 style="font-size: 40px;">Proposal Details</h1>
            </div>
            <div class="col-md-6" style="text-align: right;">
                @if (Model.Status == AgencyPro.Core.Proposals.Enums.ProposalStatus.Pending)
                {
                    @Html.ActionLink("Accept Proposal", "AcceptProposal", new { id = Model.Id }, new { @class = "btn btn-primary label-font-size" })
                }

                @if (Model.Status == AgencyPro.Core.Proposals.Enums.ProposalStatus.Pending)
                {
                    @Html.ActionLink("Reject Proposal", "RejectProposal", new { id = Model.Id }, new { @class = "btn btn-danger label-font-size" })
                }

                @Html.ActionLink("Download PDF", "DownloadProposal", new { id = Model.Id }, new { @class = "btn btn-primary label-font-size" })
            </div>
        </div>
        <hr width="100%" />

        <div class="form-group">
            <div class="col-md-6">
                <h3 class="text-color-grey label-font-bold">Account Manager</h3>
                <table class="blueTable noborder-table">
                    <tbody>
                        <tr>
                            <td style="width: 6%; padding: 0px 0px;">
                                <img class="image-circle-main" src="@Model.AccountManagerImageUrl" />
                                <img class="image-circle-sub" src="@Model.AccountManagerOrganizationImageUrl" />
                            </td>
                            <td style="width: 94%; padding: 0px 0px;">
                                <label style="margin-left: 10px;">@Model.AccountManagerName</label><br />
                                <label style="font-weight: normal; margin-left: 10px;">@Model.AccountManagerOrganizationName</label>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="text-color-grey label-font-bold">Project Manager</h3>
                <table class="blueTable noborder-table">
                    <tbody>
                        <tr>
                            <td style="width: 6%; padding: 0px 0px;">
                                <img class="image-circle-main" src="@Model.ProjectManagerImageUrl" />
                                <img class="image-circle-sub" src="@Model.ProjectManagerOrganizationImageUrl" />
                            </td>
                            <td style="width: 94%; padding: 0px 0px;">
                                <label style="margin-left: 10px;">@Model.ProjectManagerName</label><br />
                                <label style="font-weight: normal; margin-left: 10px;">@Model.ProjectManagerOrganizationName</label>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <h3 class="text-color-grey label-font-bold">Customer</h3>
                <table class="blueTable noborder-table">
                    <tbody>
                        <tr>
                            <td style="width: 6%; padding: 0px 0px;">
                                <img class="image-circle-main" src="@Model.CustomerImageUrl" />
                                <img class="image-circle-sub" src="@Model.CustomerOrganizationImageUrl" />
                            </td>
                            <td style="width: 94%; padding: 0px 0px;">
                                <label style="margin-left: 10px;">@Model.CustomerName</label><br />
                                <label style="font-weight: normal; margin-left: 10px;">@Model.CustomerOrganizationName</label>
                            </td>
                        </tr>
                    </tbody>
                </table>

            </div>

            <div class="col-md-6">

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">PROPOSAL :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.ProjectName)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">STATUS :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.Status)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">PROPOSAL TYPE :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.ProposalType)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">PROPOSED PRICE :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">$@Html.DisplayFor(model => model.TotalPriceQuoted)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">TOTAL HOURS :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.TotalHours)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">CUSTOMER RATE BASIS :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">$@Html.DisplayFor(model => model.CustomerRateBasis)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">STORY POINT BASIS :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.StoryPointBasis)</label>
                </div>

                <div class="form-group div-margin-bottom">
                    <label class="control-label col-md-7 label-no-padding-right label-font-size label-alignment text-color-grey">WEEKLY MAX HOUR BASIS :</label>
                    <label class="label-font-size col-md-5 label-no-padding-left">@Html.DisplayFor(model => model.WeeklyMaxHourBasis)</label>
                </div>

            </div>
        </div>


        <div class="form-group">
            <div class="col-md-12">
                @if (!string.IsNullOrEmpty(Model.AgreementText))
                {
                    <h3 class="text-color-grey label-font-bold">Agreement Terms</h3>
                    <p style="text-align: justify; font-size: 16px; margin-top: 10px; margin-left: 15px;">@Model.AgreementText</p>
                }
            </div>
        </div>

    </div>

    <br />

    <div class="form-group main-div">
        <div class="col-md-6">
            <h3 class="text-color-grey label-font-bold">Contracts</h3>
            <table class="blueTable">
                <thead>
                    <tr>
                        <th colspan="3">Contractor</th>
                        <th style="width: 30%; text-align: right;">Customer Rate</th>
                        <th style="width: 30%; text-align: right;">CU Max Weekly</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var contract in Model.ProposedContracts)
                    {
                        <tr>
                            <td style="padding:10px 0px; width: 4%"></td>
                            <td style="width: 5%; text-align: center; padding: 17px 0px;">
                                <img class="image-circle-main-table" src="@contract.ContractorImageUrl" />
                                <img class="image-circle-sub-table" src="@contract.ContractorOrganizationImageUrl" />
                            </td>
                            <td style="padding: 10px 0px;">
                                <label style="margin-left: 10px;">@contract.ContractorName</label><br />
                                <label style="font-weight: normal;margin-left: 10px;">@contract.ContractorOrganizationName</label>
                            </td>
                            <td style="width: 30%; text-align: right; vertical-align: middle;">$@contract.CustomerRate.ToString("N2")</td>
                            <td style="width: 30%; text-align: right; vertical-align: middle;">$@contract.MaxCustomerWeekly.ToString("N2")</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="col-md-6">
            <h3 class="text-color-grey label-font-bold" style="margin-left: 15px;">Stories</h3>
            <table class="blueTable">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th style="width: 30%;">Story Points</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var story in Model.ProposedStories)
                    {
                        <tr>
                            <td>@story.Title</td>
                            <td style="width: 30%;">@story.StoryPoints</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>

    <div id="snackbar"></div>

    <script src="~/js/vendors/jquery.min.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            @if (!string.IsNullOrEmpty(acceptMessage)) {
                @:toastFunction("@acceptMessage");
            }

            @if (!string.IsNullOrEmpty(rejectMessage)) {
                @:toastFunction("@rejectMessage");
            }
        });

        function toastFunction(message) {
            var x = document.getElementById("snackbar");
            x.innerHTML = message;
            x.className = "show";
            setTimeout(function () { x.className = x.className.replace("show", ""); }, 3000);
        }
    </script>
</body>
</html>
